{% extends "shop/admin/base_admin.html" %}
{% load humanize %}
{% block title %}Bảng điều khiển · Admin{% endblock %}
{% block page_title %}Bảng điều khiển{% endblock %}

{% block content %}
<!-- Quick tiles -->
<div class="row g-3 mb-3">
  <div class="col-6 col-lg-3">
    <div class="card tile">
      <div class="card-body d-flex align-items-center gap-3 py-3">
        <div class="display-6 text-success"><i class="bi bi-basket3"></i></div>
        <div>
          <div class="text-muted small">Sản phẩm</div>
          <div class="fs-4 fw-bold">{{ total_products|default:"—" }}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-6 col-lg-3">
    <div class="card tile">
      <div class="card-body d-flex align-items-center gap-3 py-3">
        <div class="display-6 text-success"><i class="bi bi-columns-gap"></i></div>
        <div>
          <div class="text-muted small">Danh mục</div>
          <div class="fs-4 fw-bold">{{ total_categories|default:"—" }}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-6 col-lg-3">
    <div class="card tile">
      <div class="card-body d-flex align-items-center gap-3 py-3">
        <div class="display-6 text-danger"><i class="bi bi-receipt"></i></div>
        <div>
          <div class="text-muted small">Đơn hàng</div>
          <div class="fs-4 fw-bold">{{ total_orders|default:"—" }}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-6 col-lg-3">
    <div class="card tile">
      <div class="card-body d-flex align-items-center gap-3 py-3">
        <div class="display-6 text-secondary"><i class="bi bi-people"></i></div>
        <div>
          <div class="text-muted small">Tài khoản</div>
          <div class="fs-4 fw-bold">{{ total_accounts|default:"—" }}</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Revenue tiles -->
<div class="row g-3 mb-3">
  <div class="col-6 col-lg-6">
    <div class="card tile">
      <div class="card-body py-3">
        <div class="text-muted small">Doanh thu hôm nay</div>
        <div class="display-6 fw-bold">{{ revenue_today|intcomma }} đ</div>
        <div class="text-muted">Đơn: {{ orders_today|intcomma }}</div>
      </div>
    </div>
  </div>
  <div class="col-6 col-lg-6">
    <div class="card tile">
      <div class="card-body py-3">
        <div class="text-muted small">Doanh thu tháng</div>
        <div class="display-6 fw-bold">{{ revenue_month|intcomma }} đ</div>
        <div class="text-muted">Đơn: {{ orders_month|intcomma }}</div>
      </div>
    </div>
  </div>
</div>

<!-- Charts -->
<div class="row g-3 mb-4">
  <div class="col-lg-7">
    <div class="card card-hover">
      <div class="card-body">
        <h6 class="fw-bold mb-3">Doanh thu theo ngày (14 ngày)</h6>
        <canvas id="chartDay"></canvas>
      </div>
    </div>
  </div>
  <div class="col-lg-5">
    <div class="card card-hover">
      <div class="card-body">
        <h6 class="fw-bold mb-3">Doanh thu theo tháng (12 tháng)</h6>
        <canvas id="chartMonth"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Action cards -->
<div class="row g-3">
  <div class="col-md-6 col-lg-3">
    <div class="card card-hover card-compact h-100">
      <div class="card-body">
        <div class="d-flex align-items-center mb-1">
          <i class="bi bi-basket me-2 fs-5 text-primary"></i><h6 class="mb-0">Quản lý sản phẩm</h6>
        </div>
        <p class="text-muted">Thêm/sửa nhanh sản phẩm.</p>
        <a href="#" class="btn btn-outline-primary w-100">Vào trang</a>
      </div>
    </div>
  </div>

  <div class="col-md-6 col-lg-3">
    <div class="card card-hover card-compact h-100">
      <div class="card-body">
        <div class="d-flex align-items-center mb-1">
          <i class="bi bi-grid me-2 fs-5 text-success"></i><h6 class="mb-0">Quản lý danh mục</h6>
        </div>
        <p class="text-muted">Phân nhóm rõ ràng, dễ tìm.</p>
        <a href="#" class="btn btn-outline-success w-100">Vào trang</a>
      </div>
    </div>
  </div>

  <div class="col-md-6 col-lg-3">
    <div class="card card-hover card-compact h-100">
      <div class="card-body">
        <div class="d-flex align-items-center mb-1">
          <i class="bi bi-journal-text me-2 fs-5 text-danger"></i><h6 class="mb-0">Quản lý đơn hàng</h6>
        </div>
        <p class="text-muted">Theo dõi & xử lý nhanh.</p>
        <a href="#" class="btn btn-outline-danger w-100">Vào trang</a>
      </div>
    </div>
  </div>

  <div class="col-md-6 col-lg-3">
    <div class="card card-hover card-compact h-100">
      <div class="card-body">
        <div class="d-flex align-items-center mb-1">
          <i class="bi bi-people me-2 fs-5 text-secondary"></i><h6 class="mb-0">Tài khoản</h6>
        </div>
        <p class="text-muted">Quyền & thông tin người dùng.</p>
        <a href="#" class="btn btn-outline-secondary w-100">Vào trang</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
<script>
(function(){
  const dailyLabels = {{ daily_labels|safe }};
  const dailyValues = {{ daily_values|safe }};
  const monthlyLabels = {{ monthly_labels|safe }};
  const monthlyValues = {{ monthly_values|safe }};

  new Chart(document.getElementById('chartDay'), {
    type: 'line',
    data: { labels: dailyLabels, datasets: [{ label: 'VND', data: dailyValues, tension:.3 }] },
    options: { responsive:true, scales:{ y:{ beginAtZero:true } } }
  });

  new Chart(document.getElementById('chartMonth'), {
    type: 'bar',
    data: { labels: monthlyLabels, datasets: [{ label: 'VND', data: monthlyValues }] },
    options: { responsive:true, scales:{ y:{ beginAtZero:true } } }
  });
})();
</script>
{% endblock %}
