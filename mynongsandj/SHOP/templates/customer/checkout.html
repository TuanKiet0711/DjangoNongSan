{% extends "customer/base.html" %}
{% load humanize %}

{% block title %}Thanh toán{% endblock %}

{% block content %}
<h3 class="mb-3">Xác nhận đơn hàng</h3>

{% if items %}
<div class="row">
  <div class="col-lg-8">
    <div class="card mb-3">
      <div class="card-body">
        {% for it in items %}
        <div class="d-flex align-items-center justify-content-between py-2 border-bottom">
          <div class="d-flex align-items-center gap-3">
            {% if it.hinh %}
              <img src="{{ MEDIA_URL }}{{ it.hinh }}" style="width:64px;height:64px;object-fit:cover" class="rounded">
            {% endif %}
            <div>
              <div class="fw-semibold">{{ it.ten }}</div>
              <div class="text-muted small">SL: {{ it.soLuong }} × {{ it.donGia|intcomma }}</div>
            </div>
          </div>
          <div class="fw-bold">{{ it.tongTien|intcomma }} đ</div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <form class="card" method="post" action="{% url 'shop:place_order' %}">
      {% csrf_token %}
      {% if is_buy_now %}<input type="hidden" name="buy_now_id" value="{{ buy_now_id }}">{% endif %}
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div class="text-muted">Tạm tính</div>
          <div class="fw-semibold">{{ subtotal|intcomma }} đ</div>
        </div>
        <hr>
        <div class="mb-3">
          <label class="form-label fw-semibold">Phương thức thanh toán</label>
          <select name="pttt" class="form-select">
            <option value="cod">COD (thanh toán khi nhận)</option>
            <option value="vi_dien_tu">Ví điện tử / chuyển khoản</option>
          </select>
        </div>
        <button class="btn btn-success w-100">Đặt hàng</button>
      </div>
    </form>
  </div>
</div>
{% else %}
<div class="alert alert-info">Không có sản phẩm để đặt.</div>
{% endif %}
{% endblock %}
